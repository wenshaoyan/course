#!/usr/bin/env node

/**
 * Module dependencies.
 *
 */
const {start, exit} = require('thrift-node-core');


const log4js = require('log4js');
log4js.configure(require('../config/log4js'));
global.getLogger = log4js.getLogger;

const config = require('../config/service');
global.getServiceConfig = () => {
    return config
};

const envSet = new Set(['develop', 'production']);
function getEnv() {
    let env = process.env.NODE_ENV;
    if (env && envSet.has(env)) return env;
    return 'develop';
}

global.NODE_ENV = getEnv();

start(config, function () {
    getLogger().info('http://localhost:9000')
});
process.on('exit', function() {
    exit();
});
process.on('SIGINT', function() {
    exit();
});


